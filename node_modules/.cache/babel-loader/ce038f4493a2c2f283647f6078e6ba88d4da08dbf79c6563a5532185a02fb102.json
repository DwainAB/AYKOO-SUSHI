{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./Menu.css';import{fetchRestaurantData}from'../utils/api';// Importe la fonction qui appelle l'Edge Function\nimport textJson from\"../TextJson/TextJson.json\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Menu(_ref){let{itemMin,itemMax,menuHome}=_ref;const[filter,setFilter]=useState('all');const[currentPage,setCurrentPage]=useState(1);const[itemsPerPage,setItemsPerPage]=useState(getItemsPerPage());const[foods,setFoods]=useState([]);const[categories,setCategories]=useState([]);const[cartUpdated,setCartUpdated]=useState(false);const nameRestaurant=textJson.refRestaurant;useEffect(()=>{const fetchFoodsAndCategories=async()=>{try{const{success,products,categories,error}=await fetchRestaurantData(nameRestaurant);if(!success)throw new Error(error);// Filtrer les produits pour ne garder que ceux qui ont is_deleted à false\nconst filteredProducts=products.filter(product=>!product.is_deleted);// Met à jour les états avec les données récupérées et filtrées\nsetCategories(categories);setFoods(filteredProducts);console.log(filteredProducts,categories);}catch(error){console.error(\"Erreur lors de la récupération des données :\",error);}};fetchFoodsAndCategories();},[nameRestaurant]);useEffect(()=>{const handleResize=()=>setItemsPerPage(getItemsPerPage());window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[]);function getItemsPerPage(){return window.innerWidth<=1062?itemMin:itemMax;}const filterItems=items=>{if(filter==='all')return items;return items.filter(item=>{var _categories$find;return item.category_id===((_categories$find=categories.find(cat=>cat.name===filter))===null||_categories$find===void 0?void 0:_categories$find.id);});};const filteredItems=filterItems(foods);const indexOfLastItem=currentPage*itemsPerPage;const indexOfFirstItem=indexOfLastItem-itemsPerPage;const currentItems=filteredItems.slice(indexOfFirstItem,indexOfLastItem);const paginate=pageNumber=>setCurrentPage(pageNumber);const pageNumbers=[];for(let i=1;i<=Math.ceil(filteredItems.length/itemsPerPage);i++){pageNumbers.push(i);}const addToLocalStorage=food=>{let storedFoods=JSON.parse(localStorage.getItem('cartItems'))||[];const existingFoodIndex=storedFoods.findIndex(item=>item.id===food.id);if(existingFoodIndex!==-1){storedFoods[existingFoodIndex].quantity+=1;}else{storedFoods.push({...food,quantity:1});}localStorage.setItem('cartItems',JSON.stringify(storedFoods));alert(\"Ajout\\xE9 au panier: \".concat(food.name));setCartUpdated(!cartUpdated);};return/*#__PURE__*/_jsxs(\"div\",{className:\"containerGlobalMenu\",id:\"menu\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lineMenu\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"titleMenu\",children:\"MENU\"}),/*#__PURE__*/_jsx(\"div\",{className:\"filter\",children:/*#__PURE__*/_jsxs(\"select\",{id:\"category-filter\",onChange:e=>{setFilter(e.target.value);setCurrentPage(1);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"Tous\"}),categories.map((category,index)=>/*#__PURE__*/_jsx(\"option\",{value:category.name,children:category.name},index))]})}),/*#__PURE__*/_jsx(\"h2\",{className:\"categoryTitle \".concat(filter==='all'?'allProducts':''),children:filter==='all'?'Tous nos produits':filter.charAt(0).toUpperCase()+filter.slice(1)}),/*#__PURE__*/_jsx(\"div\",{className:\"menu\",children:filteredItems.length>0?filteredItems.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"menu-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"titlePriceProduct\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[item.price.toFixed(2),\" \\u20AC\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"item-description\",\"data-full-description\":item.description,children:item.description}),menuHome&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>addToLocalStorage(item),className:\"addLocalStorage\",children:\"Ajouter\"})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"Aucun produit \\xE0 afficher.\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination\",children:pageNumbers.map(number=>/*#__PURE__*/_jsx(\"a\",{href:\"#menu\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>paginate(number),className:number===currentPage?'active':'',children:number})},number))})]});}export default Menu;","map":{"version":3,"names":["React","useState","useEffect","fetchRestaurantData","textJson","jsx","_jsx","jsxs","_jsxs","Menu","_ref","itemMin","itemMax","menuHome","filter","setFilter","currentPage","setCurrentPage","itemsPerPage","setItemsPerPage","getItemsPerPage","foods","setFoods","categories","setCategories","cartUpdated","setCartUpdated","nameRestaurant","refRestaurant","fetchFoodsAndCategories","success","products","error","Error","filteredProducts","product","is_deleted","console","log","handleResize","window","addEventListener","removeEventListener","innerWidth","filterItems","items","item","_categories$find","category_id","find","cat","name","id","filteredItems","indexOfLastItem","indexOfFirstItem","currentItems","slice","paginate","pageNumber","pageNumbers","i","Math","ceil","length","push","addToLocalStorage","food","storedFoods","JSON","parse","localStorage","getItem","existingFoodIndex","findIndex","quantity","setItem","stringify","alert","concat","className","children","onChange","e","target","value","map","category","index","charAt","toUpperCase","price","toFixed","description","onClick","number","href"],"sources":["/Users/dwainabrivard/Desktop/yumco/website/templates/template-1/Template-1-website-YumEats/src/Components/Menu/Menu.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './Menu.css';\nimport { fetchRestaurantData } from '../utils/api'; // Importe la fonction qui appelle l'Edge Function\nimport textJson from \"../TextJson/TextJson.json\";\n\nfunction Menu({itemMin, itemMax, menuHome}) {\n  const [filter, setFilter] = useState('all');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPage, setItemsPerPage] = useState(getItemsPerPage());\n  const [foods, setFoods] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [cartUpdated, setCartUpdated] = useState(false); \n  const nameRestaurant = textJson.refRestaurant;\n\n  useEffect(() => {\n    const fetchFoodsAndCategories = async () => {\n      try {\n        const { success, products, categories, error } = await fetchRestaurantData(nameRestaurant);\n\n        if (!success) throw new Error(error);\n\n        // Filtrer les produits pour ne garder que ceux qui ont is_deleted à false\n        const filteredProducts = products.filter(product => !product.is_deleted);\n\n        // Met à jour les états avec les données récupérées et filtrées\n        setCategories(categories);\n        setFoods(filteredProducts);\n        console.log(filteredProducts, categories);\n        \n      } catch (error) {\n        console.error(\"Erreur lors de la récupération des données :\", error);\n      }\n    };\n\n    fetchFoodsAndCategories();\n  }, [nameRestaurant]);\n\n  useEffect(() => {\n    const handleResize = () => setItemsPerPage(getItemsPerPage());\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  function getItemsPerPage() {\n    return window.innerWidth <= 1062 ? itemMin : itemMax;\n  }\n\n  const filterItems = (items) => {\n    if (filter === 'all') return items;\n    return items.filter(item => item.category_id === categories.find(cat => cat.name === filter)?.id); \n  };\n\n  const filteredItems = filterItems(foods);\n\n  const indexOfLastItem = currentPage * itemsPerPage;\n  const indexOfFirstItem = indexOfLastItem - itemsPerPage;\n  const currentItems = filteredItems.slice(indexOfFirstItem, indexOfLastItem);\n\n  const paginate = (pageNumber) => setCurrentPage(pageNumber);\n\n  const pageNumbers = [];\n  for (let i = 1; i <= Math.ceil(filteredItems.length / itemsPerPage); i++) {\n    pageNumbers.push(i);\n  }\n\n  const addToLocalStorage = (food) => {\n    let storedFoods = JSON.parse(localStorage.getItem('cartItems')) || [];\n\n    const existingFoodIndex = storedFoods.findIndex(item => item.id === food.id);\n\n    if (existingFoodIndex !== -1) {\n        storedFoods[existingFoodIndex].quantity += 1;\n    } else {\n        storedFoods.push({ ...food, quantity: 1 });\n    }\n\n    localStorage.setItem('cartItems', JSON.stringify(storedFoods));\n    alert(`Ajouté au panier: ${food.name}`);\n    setCartUpdated(!cartUpdated); \n  };\n\n  return (\n    <div className=\"containerGlobalMenu\" id='menu'>\n      <div className='lineMenu'></div>\n      <h2 className=\"titleMenu\">MENU</h2>\n      <div className=\"filter\">\n        <select id=\"category-filter\" onChange={(e) => { \n          setFilter(e.target.value); \n          setCurrentPage(1); \n        }}>\n          <option value=\"all\">Tous</option>\n          {categories.map((category, index) => (\n            <option key={index} value={category.name}>{category.name}</option>\n          ))}\n        </select>\n      </div>\n      <h2 className={`categoryTitle ${filter === 'all' ? 'allProducts' : ''}`}>\n        {filter === 'all' ? 'Tous nos produits' : filter.charAt(0).toUpperCase() + filter.slice(1)}\n      </h2>\n      <div className=\"menu\">\n        {filteredItems.length > 0 ? (\n          filteredItems.map((item, index) => (\n            <div key={index} className=\"menu-item\">\n              <div className='titlePriceProduct'>\n                <div className=\"item-name\">{item.name}</div>\n                <div className=\"item-price\">{item.price.toFixed(2)} €</div>\n              </div>\n              <div className=\"item-description\" data-full-description={item.description}>\n                {item.description}\n              </div>\n              {menuHome && <button onClick={() => addToLocalStorage(item)} className='addLocalStorage'>Ajouter</button>}\n            </div>\n          ))\n        ) : (\n          <p>Aucun produit à afficher.</p>\n        )}\n      </div>\n      <div className=\"pagination\">\n        {pageNumbers.map(number => (\n          <a href=\"#menu\" key={number}><button onClick={() => paginate(number)} className={number === currentPage ? 'active' : ''}>\n            {number}\n          </button></a>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default Menu;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}