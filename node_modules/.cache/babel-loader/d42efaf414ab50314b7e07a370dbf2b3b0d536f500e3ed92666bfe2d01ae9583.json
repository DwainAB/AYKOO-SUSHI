{"ast":null,"code":"var _jsxFileName = \"/Users/dwainyumco/Desktop/YumEats/website/template/template-1/template-1.0-yumco/src/Components/BasketComponent/BasketComponent.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport \"./BasketComponent.css\";\nimport textJson from \"../TextJson/TextJson.json\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction BasketComponent() {\n  _s();\n  var _deliveryModes$, _errors$firstname, _errors$lastname, _errors$email, _errors$phone, _deliveryModes$2, _errors$method, _errors$payment;\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [deliveryModes, setDeliveryModes] = useState([]);\n  const [cartItems, setCartItems] = useState([]);\n  const [isOpen, setIsOpen] = useState(false);\n  const [commentProductId, setCommentProductId] = useState(null);\n  const [tempComment, setTempComment] = useState(\"\");\n  const nameRestaurant = textJson.refRestaurant;\n  const navigate = useNavigate();\n  const openingHours = textJson.openingHours;\n  const {\n    register,\n    handleSubmit,\n    watch,\n    setValue,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues: {\n      firstname: \"\",\n      lastname: \"\",\n      email: \"\",\n      phone: \"\",\n      street: \"\",\n      country: \"\",\n      postal_code: \"\",\n      city: \"\",\n      method: \"PICKUP\",\n      payment: \"\",\n      comment: \"\",\n      ref_restaurant: nameRestaurant\n    }\n  });\n  useEffect(() => {\n    var _textJson$deliveryOpt, _textJson$deliveryOpt2;\n    //console.log(\"textJson:\", textJson);\n    const options = [];\n    if (textJson !== null && textJson !== void 0 && (_textJson$deliveryOpt = textJson.deliveryOptions) !== null && _textJson$deliveryOpt !== void 0 && _textJson$deliveryOpt.delivery) {\n      options.push({\n        value: \"DELIVERY\",\n        label: \"Livraison\"\n      });\n    }\n    if (textJson !== null && textJson !== void 0 && (_textJson$deliveryOpt2 = textJson.deliveryOptions) !== null && _textJson$deliveryOpt2 !== void 0 && _textJson$deliveryOpt2.pickup) {\n      options.push({\n        value: \"PICKUP\",\n        label: \"À emporter\"\n      });\n    }\n    setDeliveryModes(options);\n  }, [textJson]);\n  useEffect(() => {\n    if (deliveryModes.length === 1) {\n      setValue(\"method\", deliveryModes[0].value);\n    } else {\n      setValue(\"method\", \"\");\n    }\n  }, [deliveryModes, setValue]);\n  const checkIfOpen = () => {\n    const now = new Date();\n    const currentDay = now.getDay();\n    const currentHour = now.getHours() + now.getMinutes() / 60;\n    const isOpenNow = openingHours.some(({\n      day,\n      start,\n      end\n    }) => day === currentDay && currentHour >= start && currentHour < end);\n    setIsOpen(isOpenNow);\n  };\n  useEffect(() => {\n    checkIfOpen();\n    const interval = setInterval(checkIfOpen, 60000);\n    return () => clearInterval(interval);\n  }, []);\n  useEffect(() => {\n    const storedCartItems = JSON.parse(localStorage.getItem('cartItems')) || [];\n    setCartItems(storedCartItems);\n  }, []);\n  useEffect(() => {\n    const newTotalPrice = cartItems.reduce((total, item) => {\n      return total + item.price * item.quantity;\n    }, 0);\n    setTotalPrice(newTotalPrice);\n  }, [cartItems]);\n  const onSubmit = async data => {\n    try {\n      const addressData = data.street || data.city || data.postal_code || data.country ? {\n        street: data.street,\n        city: data.city,\n        postal_code: data.postal_code,\n        country: data.country,\n        category: \"ORDERS\"\n      } : null;\n      const orderPayload = {\n        order: {\n          amount_total: totalPrice,\n          amount_subtotal: totalPrice,\n          amount_tax: totalPrice,\n          status: \"PENDING\",\n          comment: data.comment,\n          payment_status: \"unpaid\",\n          requested_time: new Date().toISOString(),\n          completed_at: null,\n          restaurant_id: nameRestaurant,\n          type: data.method\n        },\n        customer: {\n          first_name: data.firstname,\n          last_name: data.lastname,\n          email: data.email,\n          phone: data.phone\n        },\n        order_items: cartItems.map(item => ({\n          quantity: item.quantity,\n          name: item.name,\n          subtotal: item.price * item.quantity,\n          unit_price: item.price,\n          product_id: item.id,\n          comment: item.comment || \"\"\n        })),\n        order_status_history: [{\n          status: \"PENDING\"\n        }]\n      };\n      if (addressData) {\n        orderPayload.address = addressData;\n      }\n      const response = await fetch('https://hfbyctqhvfgudujgdgqp.supabase.co/functions/v1/newOrder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(orderPayload)\n      });\n      if (!response.ok) {\n        throw new Error('Problème lors de l\\'envoi de la commande');\n      }\n      localStorage.setItem('userEmail', data.email);\n      const responseData = await response.json();\n      //console.log('Réponse de l\\'API :', responseData);\n\n      alert(\"Votre commande a bien été envoyée !\");\n      localStorage.removeItem('cartItems');\n      navigate('/payment-success');\n    } catch (error) {\n      console.error(\"Erreur lors de l'envoi de la commande : \", error);\n      alert('Une erreur est survenue lors de l\\'envoi de la commande.');\n    }\n  };\n  const updateQuantity = (id, delta) => {\n    const updatedCartItems = cartItems.map(item => {\n      if (item.id === id) {\n        return {\n          ...item,\n          quantity: item.quantity + delta\n        };\n      }\n      return item;\n    }).filter(item => item.quantity > 0);\n    setCartItems(updatedCartItems);\n    localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n  };\n  const handleCommentClick = productId => {\n    var _cartItems$find;\n    const existingComment = ((_cartItems$find = cartItems.find(item => item.id === productId)) === null || _cartItems$find === void 0 ? void 0 : _cartItems$find.comment) || \"\";\n    setTempComment(existingComment);\n    setCommentProductId(productId);\n    document.body.style.overflow = \"hidden\";\n  };\n  const handleCommentSubmit = () => {\n    const updatedCartItems = cartItems.map(item => {\n      if (item.id === commentProductId) {\n        return {\n          ...item,\n          comment: tempComment || \"\"\n        };\n      }\n      return item;\n    });\n    setCartItems(updatedCartItems);\n    localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n    setCommentProductId(null);\n    setTempComment(\"\");\n  };\n  const handleCommentChange = e => {\n    setTempComment(e.target.value);\n  };\n  const closeCommentInput = () => {\n    setCommentProductId(null);\n    setTempComment(\"\");\n    document.body.style.overflow = \"\";\n  };\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (commentProductId && !event.target.closest(\".comment-input\")) {\n        closeCommentInput();\n      }\n    };\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n  }, [commentProductId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"containerGlobalBasket\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerItemsBasket\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Panier\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 17\n      }, this), cartItems.length > 0 ? cartItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"containerBasketItem\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"basket-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"name-item-basket\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"textGold\",\n              children: [item.quantity, \" x\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 65\n            }, this), \" - \", item.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container-btn-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"material-symbols-outlined\",\n              onClick: () => handleCommentClick(item.id),\n              children: \"chat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => updateQuantity(item.id, 1),\n              children: \"+\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => updateQuantity(item.id, -1),\n              children: \"-\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 33\n          }, this), commentProductId === item.id && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"comment-input\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Ajouter un commentaire \\xE0 votre produit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              placeholder: \"Ajouter un commentaire\",\n              value: tempComment,\n              onChange: handleCommentChange,\n              rows: 3,\n              resize: \"vertical\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"button-comment\",\n              onClick: handleCommentSubmit,\n              children: \"Valider\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 29\n        }, this), item.comment && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"*\", item.comment]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 42\n        }, this)]\n      }, item.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 25\n      }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"basket-empty\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"material-symbols-outlined\",\n          children: \"production_quantity_limits\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Votre panier est actuellement vide\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 21\n      }, this), cartItems.length > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"total-price\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"textGold\",\n          children: \"Prix total :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 48\n        }, this), \" \", totalPrice.toFixed(2), \" \\u20AC\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerFormBasket\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit),\n        children: [deliveryModes.length === 1 && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"delivery-mode-info\",\n          children: [\"Mode de livraison : \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: (_deliveryModes$ = deliveryModes[0]) === null || _deliveryModes$ === void 0 ? void 0 : _deliveryModes$.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 49\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Pr\\xE9nom\",\n          ...register(\"firstname\", {\n            required: \"Prénom requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$firstname = errors.firstname) === null || _errors$firstname === void 0 ? void 0 : _errors$firstname.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Nom\",\n          ...register(\"lastname\", {\n            required: \"Nom requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$lastname = errors.lastname) === null || _errors$lastname === void 0 ? void 0 : _errors$lastname.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          placeholder: \"Email\",\n          ...register(\"email\", {\n            required: \"Email requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$email = errors.email) === null || _errors$email === void 0 ? void 0 : _errors$email.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"tel\",\n          placeholder: \"T\\xE9l\\xE9phone\",\n          ...register(\"phone\", {\n            required: \"Téléphone requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$phone = errors.phone) === null || _errors$phone === void 0 ? void 0 : _errors$phone.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 21\n        }, this), watch(\"method\") === \"DELIVERY\" && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container-input-delivery\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Code postal\",\n            ...register(\"postal_code\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Pays\",\n            ...register(\"country\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Ville\",\n            ...register(\"city\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Adresse\",\n            ...register(\"street\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 25\n        }, this), deliveryModes.length > 1 ? /*#__PURE__*/_jsxDEV(\"select\", {\n          ...register(\"method\", {\n            required: \"Sélectionnez un mode de livraison\"\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Mode de livraison\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 29\n          }, this), deliveryModes.map(({\n            value,\n            label\n          }) => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: value,\n            children: label\n          }, value, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 33\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"hidden\",\n          ...register(\"method\"),\n          value: (_deliveryModes$2 = deliveryModes[0]) === null || _deliveryModes$2 === void 0 ? void 0 : _deliveryModes$2.value\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$method = errors.method) === null || _errors$method === void 0 ? void 0 : _errors$method.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"select-payment\",\n          ...register(\"payment\", {\n            required: \"Sélectionnez un mode de paiement\"\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Mode de paiement\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"CASH\",\n            children: \"Esp\\xE8ces\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"CB\",\n            children: \"Carte bancaire\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$payment = errors.payment) === null || _errors$payment === void 0 ? void 0 : _errors$payment.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          placeholder: \"Commentaire\",\n          ...register(\"comment\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: {\n            marginTop: \"20px\"\n          },\n          type: \"submit\",\n          value: \"Commander\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 215,\n    columnNumber: 9\n  }, this);\n}\n_s(BasketComponent, \"7cGNcT7TWZwCRCO+hBQrmtLkfXA=\", false, function () {\n  return [useNavigate, useForm];\n});\n_c = BasketComponent;\nexport default BasketComponent;\nvar _c;\n$RefreshReg$(_c, \"BasketComponent\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useForm","textJson","jsxDEV","_jsxDEV","BasketComponent","_s","_deliveryModes$","_errors$firstname","_errors$lastname","_errors$email","_errors$phone","_deliveryModes$2","_errors$method","_errors$payment","totalPrice","setTotalPrice","deliveryModes","setDeliveryModes","cartItems","setCartItems","isOpen","setIsOpen","commentProductId","setCommentProductId","tempComment","setTempComment","nameRestaurant","refRestaurant","navigate","openingHours","register","handleSubmit","watch","setValue","formState","errors","defaultValues","firstname","lastname","email","phone","street","country","postal_code","city","method","payment","comment","ref_restaurant","_textJson$deliveryOpt","_textJson$deliveryOpt2","options","deliveryOptions","delivery","push","value","label","pickup","length","checkIfOpen","now","Date","currentDay","getDay","currentHour","getHours","getMinutes","isOpenNow","some","day","start","end","interval","setInterval","clearInterval","storedCartItems","JSON","parse","localStorage","getItem","newTotalPrice","reduce","total","item","price","quantity","onSubmit","data","addressData","category","orderPayload","order","amount_total","amount_subtotal","amount_tax","status","payment_status","requested_time","toISOString","completed_at","restaurant_id","type","customer","first_name","last_name","order_items","map","name","subtotal","unit_price","product_id","id","order_status_history","address","response","fetch","headers","body","stringify","ok","Error","setItem","responseData","json","alert","removeItem","error","console","updateQuantity","delta","updatedCartItems","filter","handleCommentClick","productId","_cartItems$find","existingComment","find","document","style","overflow","handleCommentSubmit","handleCommentChange","e","target","closeCommentInput","handleClickOutside","event","closest","addEventListener","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","placeholder","onChange","rows","resize","toFixed","required","message","marginTop","_c","$RefreshReg$"],"sources":["/Users/dwainyumco/Desktop/YumEats/website/template/template-1/template-1.0-yumco/src/Components/BasketComponent/BasketComponent.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport \"./BasketComponent.css\";\nimport textJson from \"../TextJson/TextJson.json\";\n\nfunction BasketComponent() {\n    const [totalPrice, setTotalPrice] = useState(0);\n    const [deliveryModes, setDeliveryModes] = useState([]);\n    const [cartItems, setCartItems] = useState([]);\n    const [isOpen, setIsOpen] = useState(false);\n    const [commentProductId, setCommentProductId] = useState(null); \n    const [tempComment, setTempComment] = useState(\"\"); \n    const nameRestaurant = textJson.refRestaurant;\n    const navigate = useNavigate();\n    const openingHours = textJson.openingHours;\n\n    const { register, handleSubmit, watch, setValue, formState: { errors } } = useForm({\n        defaultValues: {\n            firstname: \"\",\n            lastname: \"\",\n            email: \"\",\n            phone: \"\",\n            street: \"\",\n            country: \"\",\n            postal_code: \"\",\n            city: \"\",\n            method: \"PICKUP\",\n            payment: \"\",\n            comment: \"\",\n            ref_restaurant: nameRestaurant\n        }\n    });\n\n    useEffect(() => {\n        //console.log(\"textJson:\", textJson);\n        const options = [];\n        if (textJson?.deliveryOptions?.delivery) {\n            options.push({ value: \"DELIVERY\", label: \"Livraison\" });\n        }\n        if (textJson?.deliveryOptions?.pickup) {\n            options.push({ value: \"PICKUP\", label: \"À emporter\" });\n        }\n        setDeliveryModes(options);\n    }, [textJson]);\n\n    useEffect(() => {\n        if (deliveryModes.length === 1) {\n            setValue(\"method\", deliveryModes[0].value); \n        } else {\n            setValue(\"method\", \"\"); \n        }\n    }, [deliveryModes, setValue]);\n    \n    \n    \n    const checkIfOpen = () => {\n        const now = new Date();\n        const currentDay = now.getDay();\n        const currentHour = now.getHours() + now.getMinutes() / 60;\n\n        const isOpenNow = openingHours.some(\n            ({ day, start, end }) => day === currentDay && currentHour >= start && currentHour < end\n        );\n\n        setIsOpen(isOpenNow);\n    };\n\n    useEffect(() => {\n        checkIfOpen();\n        const interval = setInterval(checkIfOpen, 60000);\n        return () => clearInterval(interval);\n    }, []);\n\n    useEffect(() => {\n        const storedCartItems = JSON.parse(localStorage.getItem('cartItems')) || [];\n        setCartItems(storedCartItems);\n    }, []);\n\n    useEffect(() => {\n        const newTotalPrice = cartItems.reduce((total, item) => {\n            return total + (item.price * item.quantity);\n        }, 0);\n        setTotalPrice(newTotalPrice);\n    }, [cartItems]);\n\n    const onSubmit = async (data) => {\n        try {\n            const addressData = (data.street || data.city || data.postal_code || data.country) ? {\n                street: data.street,\n                city: data.city,\n                postal_code: data.postal_code,\n                country: data.country,\n                category: \"ORDERS\",\n            } : null;\n\n            const orderPayload = {\n                order: {\n                    amount_total: totalPrice,\n                    amount_subtotal: totalPrice,\n                    amount_tax: totalPrice,\n                    status: \"PENDING\",\n                    comment: data.comment,\n                    payment_status: \"unpaid\",\n                    requested_time: new Date().toISOString(),\n                    completed_at: null,\n                    restaurant_id: nameRestaurant,\n                    type: data.method,\n                },\n                customer: {\n                    first_name: data.firstname,\n                    last_name: data.lastname,\n                    email: data.email,\n                    phone: data.phone,\n                },\n                order_items: cartItems.map((item) => ({\n                    quantity: item.quantity,\n                    name: item.name,\n                    subtotal: item.price * item.quantity,\n                    unit_price: item.price,\n                    product_id: item.id,\n                    comment: item.comment || \"\",\n                })),\n                order_status_history: [\n                    {\n                        status: \"PENDING\",\n                    },\n                ],\n            };\n\n            if (addressData) {\n                orderPayload.address = addressData;\n            }\n\n            const response = await fetch('https://hfbyctqhvfgudujgdgqp.supabase.co/functions/v1/newOrder', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(orderPayload),\n            });\n\n            if (!response.ok) {\n                throw new Error('Problème lors de l\\'envoi de la commande');\n            }\n            localStorage.setItem('userEmail', data.email);\n            const responseData = await response.json();\n            //console.log('Réponse de l\\'API :', responseData);\n\n            alert(\"Votre commande a bien été envoyée !\");\n            localStorage.removeItem('cartItems');\n            navigate('/payment-success');\n        } catch (error) {\n            console.error(\"Erreur lors de l'envoi de la commande : \", error);\n            alert('Une erreur est survenue lors de l\\'envoi de la commande.');\n        }\n    };\n\n    const updateQuantity = (id, delta) => {\n        const updatedCartItems = cartItems.map(item => {\n            if (item.id === id) {\n                return { ...item, quantity: item.quantity + delta };\n            }\n            return item;\n        }).filter(item => item.quantity > 0);\n\n        setCartItems(updatedCartItems);\n        localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n    };\n\n    const handleCommentClick = (productId) => {\n        const existingComment = cartItems.find(item => item.id === productId)?.comment || \"\";\n        setTempComment(existingComment);\n        setCommentProductId(productId);\n        document.body.style.overflow = \"hidden\";\n    };\n\n    const handleCommentSubmit = () => {\n        const updatedCartItems = cartItems.map(item => {\n            if (item.id === commentProductId) {\n                return { ...item, comment: tempComment || \"\" };\n            }\n            return item;\n        });\n\n        setCartItems(updatedCartItems);\n        localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n        setCommentProductId(null);\n        setTempComment(\"\");\n    };\n\n    const handleCommentChange = (e) => {\n        setTempComment(e.target.value);\n    };\n\n    const closeCommentInput = () => {\n        setCommentProductId(null);\n        setTempComment(\"\");\n        document.body.style.overflow = \"\";\n    };\n\n    useEffect(() => {\n        const handleClickOutside = (event) => {\n            if (commentProductId && !event.target.closest(\".comment-input\")) {\n                closeCommentInput();\n            }\n        };\n\n        document.addEventListener(\"mousedown\", handleClickOutside);\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n    }, [commentProductId]);\n\n\n    return (\n        <div className=\"containerGlobalBasket\">\n            <div className=\"containerItemsBasket\">\n                <h2>Panier</h2>\n                {cartItems.length > 0 ? (\n                    cartItems.map((item) => (\n                        <div key={item.id} className=\"containerBasketItem\">\n                            <div  className=\"basket-item\">\n                                <p className=\"name-item-basket\"><span className=\"textGold\">{item.quantity} x</span> - {item.name}</p>\n                                <div className=\"container-btn-item\">\n                                    <span \n                                        className=\"material-symbols-outlined\" \n                                        onClick={() => handleCommentClick(item.id)}\n                                    >chat</span>\n                                    <button onClick={() => updateQuantity(item.id, 1)}>+</button>\n                                    <button onClick={() => updateQuantity(item.id, -1)}>-</button>\n                                </div>\n                                {commentProductId === item.id && (\n                                    <div className=\"comment-input\">\n                                        <h3>Ajouter un commentaire à votre produit</h3>\n                                        <textarea \n                                            placeholder=\"Ajouter un commentaire\"\n                                            value={tempComment}\n                                            onChange={handleCommentChange}\n                                            rows={3}\n                                            resize=\"vertical\"\n                                        />\n                                        <button className=\"button-comment\" onClick={handleCommentSubmit}>Valider</button>\n                                    </div>\n                                )}\n                            </div>\n                        {item.comment && <p>*{item.comment}</p>}\n                        </div>\n                    ))\n                ) : (\n                    <div className=\"basket-empty\">\n                        <span className=\"material-symbols-outlined\">production_quantity_limits</span>\n                        <p>Votre panier est actuellement vide</p>\n                    </div>\n                )}\n                {cartItems.length > 0 && (\n                    <p className=\"total-price\"><span className=\"textGold\">Prix total :</span> {totalPrice.toFixed(2)} €</p>\n                )}\n            </div>\n\n            <div className=\"containerFormBasket\">\n\n                <form onSubmit={handleSubmit(onSubmit)}>\n                    {deliveryModes.length === 1 && (\n                        <p className=\"delivery-mode-info\">\n                            Mode de livraison : <strong>{deliveryModes[0]?.label}</strong>\n                        </p>\n                    )}\n                    <input type=\"text\" placeholder=\"Prénom\" {...register(\"firstname\", { required: \"Prénom requis\" })} />\n                    <p className=\"error-message\">{errors.firstname?.message}</p>\n\n                    <input type=\"text\" placeholder=\"Nom\" {...register(\"lastname\", { required: \"Nom requis\" })} />\n                    <p className=\"error-message\">{errors.lastname?.message}</p>\n\n                    <input type=\"email\" placeholder=\"Email\" {...register(\"email\", { required: \"Email requis\" })} />\n                    <p className=\"error-message\">{errors.email?.message}</p>\n\n                    <input type=\"tel\" placeholder=\"Téléphone\" {...register(\"phone\", { required: \"Téléphone requis\" })} />\n                    <p className=\"error-message\">{errors.phone?.message}</p>\n\n                    {watch(\"method\") === \"DELIVERY\" && (\n                        <div className=\"container-input-delivery\">\n                            <input type=\"text\" placeholder=\"Code postal\" {...register(\"postal_code\")} />\n                            <input type=\"text\" placeholder=\"Pays\" {...register(\"country\")} />\n                            <input type=\"text\" placeholder=\"Ville\" {...register(\"city\")} />\n                            <input type=\"text\" placeholder=\"Adresse\" {...register(\"street\")} />\n                        </div>\n                    )}\n\n                    {deliveryModes.length > 1 ? (\n                        <select {...register(\"method\", { required: \"Sélectionnez un mode de livraison\" })}>\n                            <option value=\"\">Mode de livraison</option>\n                            {deliveryModes.map(({ value, label }) => (\n                                <option key={value} value={value}>\n                                    {label}\n                                </option>\n                            ))}\n                        </select>\n                    ) : (\n                        <input type=\"hidden\" {...register(\"method\")} value={deliveryModes[0]?.value} />\n\n                    )}\n                    <p className=\"error-message\">{errors.method?.message}</p>\n\n\n\n\n                    <select className=\"select-payment\" {...register(\"payment\", { required: \"Sélectionnez un mode de paiement\" })}>\n                        <option value=\"\">Mode de paiement</option>\n                        <option value=\"CASH\">Espèces</option>\n                        <option value=\"CB\">Carte bancaire</option>\n                    </select>\n                    <p className=\"error-message\">{errors.payment?.message}</p>\n\n                    <textarea placeholder=\"Commentaire\" {...register(\"comment\")}></textarea>\n                    <input style={{marginTop:\"20px\"}}  type=\"submit\" value={\"Commander\"}/>\n                </form>\n            </div>\n        </div>\n    );\n}\n\nexport default BasketComponent;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}