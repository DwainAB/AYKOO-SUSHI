{"ast":null,"code":"var _jsxFileName = \"/Users/dwainyumco/Desktop/YumEats/website/template/template-1/template-1.0-yumco/src/Components/BasketComponent/BasketComponent.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport \"./BasketComponent.css\";\nimport textJson from \"../TextJson/TextJson.json\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction BasketComponent() {\n  _s();\n  var _deliveryModes$, _errors$firstname, _errors$lastname, _errors$email, _errors$phone, _deliveryModes$2, _errors$method, _errors$payment;\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [deliveryModes, setDeliveryModes] = useState([]);\n  const [cartItems, setCartItems] = useState([]);\n  const [isOpen, setIsOpen] = useState(false);\n  const [commentProductId, setCommentProductId] = useState(null);\n  const [tempComment, setTempComment] = useState(\"\");\n  const nameRestaurant = textJson.refRestaurant;\n  const navigate = useNavigate();\n  const openingHours = textJson.openingHours;\n  const {\n    register,\n    handleSubmit,\n    watch,\n    setValue,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues: {\n      firstname: \"\",\n      lastname: \"\",\n      email: \"\",\n      phone: \"\",\n      street: \"\",\n      country: \"\",\n      postal_code: \"\",\n      city: \"\",\n      method: \"PICKUP\",\n      payment: \"\",\n      comment: \"\",\n      ref_restaurant: nameRestaurant\n    }\n  });\n  useEffect(() => {\n    var _textJson$deliveryOpt, _textJson$deliveryOpt2;\n    //console.log(\"textJson:\", textJson);\n    const options = [];\n    if (textJson !== null && textJson !== void 0 && (_textJson$deliveryOpt = textJson.deliveryOptions) !== null && _textJson$deliveryOpt !== void 0 && _textJson$deliveryOpt.delivery) {\n      options.push({\n        value: \"DELIVERY\",\n        label: \"Livraison\"\n      });\n    }\n    if (textJson !== null && textJson !== void 0 && (_textJson$deliveryOpt2 = textJson.deliveryOptions) !== null && _textJson$deliveryOpt2 !== void 0 && _textJson$deliveryOpt2.pickup) {\n      options.push({\n        value: \"PICKUP\",\n        label: \"À emporter\"\n      });\n    }\n    setDeliveryModes(options);\n  }, [textJson]);\n  useEffect(() => {\n    if (deliveryModes.length === 1) {\n      setValue(\"method\", deliveryModes[0].value);\n    } else {\n      setValue(\"method\", \"\");\n    }\n  }, [deliveryModes, setValue]);\n  const checkIfOpen = () => {\n    const now = new Date();\n    const currentDay = now.getDay();\n    const currentHour = now.getHours() + now.getMinutes() / 60;\n    const isOpenNow = openingHours.some(({\n      day,\n      start,\n      end\n    }) => day === currentDay && currentHour >= start && currentHour < end);\n    setIsOpen(isOpenNow);\n  };\n  useEffect(() => {\n    checkIfOpen();\n    const interval = setInterval(checkIfOpen, 60000);\n    return () => clearInterval(interval);\n  }, []);\n  useEffect(() => {\n    const storedCartItems = JSON.parse(localStorage.getItem('cartItems')) || [];\n    setCartItems(storedCartItems);\n  }, []);\n  useEffect(() => {\n    const newTotalPrice = cartItems.reduce((total, item) => {\n      return total + item.price * item.quantity;\n    }, 0);\n    setTotalPrice(newTotalPrice);\n  }, [cartItems]);\n  const onSubmit = async data => {\n    try {\n      const orderPayload = {\n        // Informations client\n        first_name: data.firstname,\n        last_name: data.lastname,\n        email: data.email,\n        phone: data.phone,\n        // Informations adresse (si livraison)\n        street: data.street || \"\",\n        city: data.city || \"\",\n        postal_code: data.postal_code || \"\",\n        country: data.country || \"\",\n        // Informations commande\n        amount_total: totalPrice,\n        amount_subtotal: totalPrice,\n        amount_tax: totalPrice * 0.1,\n        // 10% de TVA par exemple\n        status: \"PENDING\",\n        comment: data.comment || \"\",\n        payment_status: \"UNPAID\",\n        // En majuscules comme dans Bruno\n        restaurant_id: nameRestaurant,\n        type: data.method,\n        // Items de la commande avec tous les champs nécessaires\n        order_items: cartItems.map(item => ({\n          quantity: item.quantity,\n          name: item.name,\n          unit_price: item.price,\n          subtotal: item.price * item.quantity,\n          product_id: item.product_id,\n          // Assurez-vous que c'est le bon ID\n          comment: item.comment || \"\"\n        }))\n      };\n      console.log(\"Données envoyées:\", JSON.stringify(orderPayload, null, 2)); // Pour déboguer\n\n      const response = await fetch('https://hfbyctqhvfgudujgdgqp.supabase.co/functions/v1/newOrder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          \"Authorization\": \"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhmYnljdHFodmZndWR1amdkZ3FwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU4NTc0MDIsImV4cCI6MjA1MTQzMzQwMn0.9g3N_aV4M5UWGYCuCLXgFnVjdDxIEm7TJqFzIk0r2Ho\"\n        },\n        body: JSON.stringify(orderPayload)\n      });\n      const responseData = await response.json();\n      console.log(\"Réponse reçue:\", responseData); // Pour déboguer\n\n      if (!response.ok) {\n        throw new Error(responseData.error || 'Problème lors de l\\'envoi de la commande');\n      }\n      if (responseData.success) {\n        alert(\"Votre commande a bien été envoyée !\");\n        localStorage.setItem('userEmail', data.email);\n        localStorage.removeItem('cartItems');\n        navigate('/payment-success');\n      } else {\n        throw new Error(responseData.error || 'Erreur lors de l\\'envoi de la commande');\n      }\n    } catch (error) {\n      console.error(\"Erreur détaillée:\", error);\n      alert('Une erreur est survenue lors de l\\'envoi de la commande : ' + error.message);\n    }\n  };\n  const updateQuantity = (id, delta) => {\n    const updatedCartItems = cartItems.map(item => {\n      if (item.id === id) {\n        return {\n          ...item,\n          quantity: item.quantity + delta\n        };\n      }\n      return item;\n    }).filter(item => item.quantity > 0);\n    setCartItems(updatedCartItems);\n    localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n  };\n  const handleCommentClick = productId => {\n    var _cartItems$find;\n    const existingComment = ((_cartItems$find = cartItems.find(item => item.id === productId)) === null || _cartItems$find === void 0 ? void 0 : _cartItems$find.comment) || \"\";\n    setTempComment(existingComment);\n    setCommentProductId(productId);\n    document.body.style.overflow = \"hidden\";\n  };\n  const handleCommentSubmit = () => {\n    const updatedCartItems = cartItems.map(item => {\n      if (item.id === commentProductId) {\n        return {\n          ...item,\n          comment: tempComment || \"\"\n        };\n      }\n      return item;\n    });\n    setCartItems(updatedCartItems);\n    localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n    setCommentProductId(null);\n    setTempComment(\"\");\n  };\n  const handleCommentChange = e => {\n    setTempComment(e.target.value);\n  };\n  const closeCommentInput = () => {\n    setCommentProductId(null);\n    setTempComment(\"\");\n    document.body.style.overflow = \"\";\n  };\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (commentProductId && !event.target.closest(\".comment-input\")) {\n        closeCommentInput();\n      }\n    };\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n  }, [commentProductId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"containerGlobalBasket\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerItemsBasket\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Panier\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 17\n      }, this), cartItems.length > 0 ? cartItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"containerBasketItem\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"basket-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"name-item-basket\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"textGold\",\n              children: [item.quantity, \" x\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 65\n            }, this), \" - \", item.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container-btn-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"material-symbols-outlined\",\n              onClick: () => handleCommentClick(item.id),\n              children: \"chat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => updateQuantity(item.id, 1),\n              children: \"+\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => updateQuantity(item.id, -1),\n              children: \"-\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 33\n          }, this), commentProductId === item.id && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"comment-input\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Ajouter un commentaire \\xE0 votre produit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              placeholder: \"Ajouter un commentaire\",\n              value: tempComment,\n              onChange: handleCommentChange,\n              rows: 3,\n              resize: \"vertical\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"button-comment\",\n              onClick: handleCommentSubmit,\n              children: \"Valider\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 29\n        }, this), item.comment && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"*\", item.comment]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 42\n        }, this)]\n      }, item.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 25\n      }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"basket-empty\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"material-symbols-outlined\",\n          children: \"production_quantity_limits\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Votre panier est actuellement vide\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 21\n      }, this), cartItems.length > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"total-price\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"textGold\",\n          children: \"Prix total :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 48\n        }, this), \" \", totalPrice.toFixed(2), \" \\u20AC\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerFormBasket\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit),\n        children: [deliveryModes.length === 1 && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"delivery-mode-info\",\n          children: [\"Mode de livraison : \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: (_deliveryModes$ = deliveryModes[0]) === null || _deliveryModes$ === void 0 ? void 0 : _deliveryModes$.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 49\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Pr\\xE9nom\",\n          ...register(\"firstname\", {\n            required: \"Prénom requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$firstname = errors.firstname) === null || _errors$firstname === void 0 ? void 0 : _errors$firstname.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Nom\",\n          ...register(\"lastname\", {\n            required: \"Nom requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$lastname = errors.lastname) === null || _errors$lastname === void 0 ? void 0 : _errors$lastname.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          placeholder: \"Email\",\n          ...register(\"email\", {\n            required: \"Email requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$email = errors.email) === null || _errors$email === void 0 ? void 0 : _errors$email.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"tel\",\n          placeholder: \"T\\xE9l\\xE9phone\",\n          ...register(\"phone\", {\n            required: \"Téléphone requis\"\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$phone = errors.phone) === null || _errors$phone === void 0 ? void 0 : _errors$phone.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 21\n        }, this), watch(\"method\") === \"DELIVERY\" && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container-input-delivery\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Code postal\",\n            ...register(\"postal_code\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Pays\",\n            ...register(\"country\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Ville\",\n            ...register(\"city\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Adresse\",\n            ...register(\"street\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 25\n        }, this), deliveryModes.length > 1 ? /*#__PURE__*/_jsxDEV(\"select\", {\n          ...register(\"method\", {\n            required: \"Sélectionnez un mode de livraison\"\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Mode de livraison\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 29\n          }, this), deliveryModes.map(({\n            value,\n            label\n          }) => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: value,\n            children: label\n          }, value, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 33\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"hidden\",\n          ...register(\"method\"),\n          value: (_deliveryModes$2 = deliveryModes[0]) === null || _deliveryModes$2 === void 0 ? void 0 : _deliveryModes$2.value\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$method = errors.method) === null || _errors$method === void 0 ? void 0 : _errors$method.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"select-payment\",\n          ...register(\"payment\", {\n            required: \"Sélectionnez un mode de paiement\"\n          }),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Mode de paiement\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"CASH\",\n            children: \"Esp\\xE8ces\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"CB\",\n            children: \"Carte bancaire\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: (_errors$payment = errors.payment) === null || _errors$payment === void 0 ? void 0 : _errors$payment.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          placeholder: \"Commentaire\",\n          ...register(\"comment\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: {\n            marginTop: \"20px\"\n          },\n          type: \"submit\",\n          value: \"Commander\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 212,\n    columnNumber: 9\n  }, this);\n}\n_s(BasketComponent, \"7cGNcT7TWZwCRCO+hBQrmtLkfXA=\", false, function () {\n  return [useNavigate, useForm];\n});\n_c = BasketComponent;\nexport default BasketComponent;\nvar _c;\n$RefreshReg$(_c, \"BasketComponent\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useForm","textJson","jsxDEV","_jsxDEV","BasketComponent","_s","_deliveryModes$","_errors$firstname","_errors$lastname","_errors$email","_errors$phone","_deliveryModes$2","_errors$method","_errors$payment","totalPrice","setTotalPrice","deliveryModes","setDeliveryModes","cartItems","setCartItems","isOpen","setIsOpen","commentProductId","setCommentProductId","tempComment","setTempComment","nameRestaurant","refRestaurant","navigate","openingHours","register","handleSubmit","watch","setValue","formState","errors","defaultValues","firstname","lastname","email","phone","street","country","postal_code","city","method","payment","comment","ref_restaurant","_textJson$deliveryOpt","_textJson$deliveryOpt2","options","deliveryOptions","delivery","push","value","label","pickup","length","checkIfOpen","now","Date","currentDay","getDay","currentHour","getHours","getMinutes","isOpenNow","some","day","start","end","interval","setInterval","clearInterval","storedCartItems","JSON","parse","localStorage","getItem","newTotalPrice","reduce","total","item","price","quantity","onSubmit","data","orderPayload","first_name","last_name","amount_total","amount_subtotal","amount_tax","status","payment_status","restaurant_id","type","order_items","map","name","unit_price","subtotal","product_id","console","log","stringify","response","fetch","headers","body","responseData","json","ok","Error","error","success","alert","setItem","removeItem","message","updateQuantity","id","delta","updatedCartItems","filter","handleCommentClick","productId","_cartItems$find","existingComment","find","document","style","overflow","handleCommentSubmit","handleCommentChange","e","target","closeCommentInput","handleClickOutside","event","closest","addEventListener","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","placeholder","onChange","rows","resize","toFixed","required","marginTop","_c","$RefreshReg$"],"sources":["/Users/dwainyumco/Desktop/YumEats/website/template/template-1/template-1.0-yumco/src/Components/BasketComponent/BasketComponent.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport \"./BasketComponent.css\";\nimport textJson from \"../TextJson/TextJson.json\";\n\nfunction BasketComponent() {\n    const [totalPrice, setTotalPrice] = useState(0);\n    const [deliveryModes, setDeliveryModes] = useState([]);\n    const [cartItems, setCartItems] = useState([]);\n    const [isOpen, setIsOpen] = useState(false);\n    const [commentProductId, setCommentProductId] = useState(null); \n    const [tempComment, setTempComment] = useState(\"\"); \n    const nameRestaurant = textJson.refRestaurant;\n    const navigate = useNavigate();\n    const openingHours = textJson.openingHours;\n\n    const { register, handleSubmit, watch, setValue, formState: { errors } } = useForm({\n        defaultValues: {\n            firstname: \"\",\n            lastname: \"\",\n            email: \"\",\n            phone: \"\",\n            street: \"\",\n            country: \"\",\n            postal_code: \"\",\n            city: \"\",\n            method: \"PICKUP\",\n            payment: \"\",\n            comment: \"\",\n            ref_restaurant: nameRestaurant\n        }\n    });\n\n    useEffect(() => {\n        //console.log(\"textJson:\", textJson);\n        const options = [];\n        if (textJson?.deliveryOptions?.delivery) {\n            options.push({ value: \"DELIVERY\", label: \"Livraison\" });\n        }\n        if (textJson?.deliveryOptions?.pickup) {\n            options.push({ value: \"PICKUP\", label: \"À emporter\" });\n        }\n        setDeliveryModes(options);\n    }, [textJson]);\n\n    useEffect(() => {\n        if (deliveryModes.length === 1) {\n            setValue(\"method\", deliveryModes[0].value); \n        } else {\n            setValue(\"method\", \"\"); \n        }\n    }, [deliveryModes, setValue]);\n    \n    \n    \n    const checkIfOpen = () => {\n        const now = new Date();\n        const currentDay = now.getDay();\n        const currentHour = now.getHours() + now.getMinutes() / 60;\n\n        const isOpenNow = openingHours.some(\n            ({ day, start, end }) => day === currentDay && currentHour >= start && currentHour < end\n        );\n\n        setIsOpen(isOpenNow);\n    };\n\n    useEffect(() => {\n        checkIfOpen();\n        const interval = setInterval(checkIfOpen, 60000);\n        return () => clearInterval(interval);\n    }, []);\n\n    useEffect(() => {\n        const storedCartItems = JSON.parse(localStorage.getItem('cartItems')) || [];\n        setCartItems(storedCartItems);\n    }, []);\n\n    useEffect(() => {\n        const newTotalPrice = cartItems.reduce((total, item) => {\n            return total + (item.price * item.quantity);\n        }, 0);\n        setTotalPrice(newTotalPrice);\n    }, [cartItems]);\n\n    const onSubmit = async (data) => {\n        try {\n            const orderPayload = {\n                // Informations client\n                first_name: data.firstname,\n                last_name: data.lastname,\n                email: data.email,\n                phone: data.phone,\n                \n                // Informations adresse (si livraison)\n                street: data.street || \"\",\n                city: data.city || \"\",\n                postal_code: data.postal_code || \"\",\n                country: data.country || \"\",\n                \n                // Informations commande\n                amount_total: totalPrice,\n                amount_subtotal: totalPrice,\n                amount_tax: totalPrice * 0.1, // 10% de TVA par exemple\n                status: \"PENDING\",\n                comment: data.comment || \"\",\n                payment_status: \"UNPAID\",  // En majuscules comme dans Bruno\n                restaurant_id: nameRestaurant,\n                type: data.method,\n                \n                // Items de la commande avec tous les champs nécessaires\n                order_items: cartItems.map((item) => ({\n                    quantity: item.quantity,\n                    name: item.name,\n                    unit_price: item.price,\n                    subtotal: item.price * item.quantity,\n                    product_id: item.product_id, // Assurez-vous que c'est le bon ID\n                    comment: item.comment || \"\"\n                }))\n            };\n    \n            console.log(\"Données envoyées:\", JSON.stringify(orderPayload, null, 2)); // Pour déboguer\n    \n            const response = await fetch('https://hfbyctqhvfgudujgdgqp.supabase.co/functions/v1/newOrder', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    \"Authorization\": \"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhmYnljdHFodmZndWR1amdkZ3FwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU4NTc0MDIsImV4cCI6MjA1MTQzMzQwMn0.9g3N_aV4M5UWGYCuCLXgFnVjdDxIEm7TJqFzIk0r2Ho\"\n                },\n                body: JSON.stringify(orderPayload)\n            });\n    \n            const responseData = await response.json();\n            console.log(\"Réponse reçue:\", responseData); // Pour déboguer\n    \n            if (!response.ok) {\n                throw new Error(responseData.error || 'Problème lors de l\\'envoi de la commande');\n            }\n            \n            if (responseData.success) {\n                alert(\"Votre commande a bien été envoyée !\");\n                localStorage.setItem('userEmail', data.email);\n                localStorage.removeItem('cartItems');\n                navigate('/payment-success');\n            } else {\n                throw new Error(responseData.error || 'Erreur lors de l\\'envoi de la commande');\n            }\n    \n        } catch (error) {\n            console.error(\"Erreur détaillée:\", error);\n            alert('Une erreur est survenue lors de l\\'envoi de la commande : ' + error.message);\n        }\n    };\n\n    const updateQuantity = (id, delta) => {\n        const updatedCartItems = cartItems.map(item => {\n            if (item.id === id) {\n                return { ...item, quantity: item.quantity + delta };\n            }\n            return item;\n        }).filter(item => item.quantity > 0);\n\n        setCartItems(updatedCartItems);\n        localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n    };\n\n    const handleCommentClick = (productId) => {\n        const existingComment = cartItems.find(item => item.id === productId)?.comment || \"\";\n        setTempComment(existingComment);\n        setCommentProductId(productId);\n        document.body.style.overflow = \"hidden\";\n    };\n\n    const handleCommentSubmit = () => {\n        const updatedCartItems = cartItems.map(item => {\n            if (item.id === commentProductId) {\n                return { ...item, comment: tempComment || \"\" };\n            }\n            return item;\n        });\n\n        setCartItems(updatedCartItems);\n        localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));\n        setCommentProductId(null);\n        setTempComment(\"\");\n    };\n\n    const handleCommentChange = (e) => {\n        setTempComment(e.target.value);\n    };\n\n    const closeCommentInput = () => {\n        setCommentProductId(null);\n        setTempComment(\"\");\n        document.body.style.overflow = \"\";\n    };\n\n    useEffect(() => {\n        const handleClickOutside = (event) => {\n            if (commentProductId && !event.target.closest(\".comment-input\")) {\n                closeCommentInput();\n            }\n        };\n\n        document.addEventListener(\"mousedown\", handleClickOutside);\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n    }, [commentProductId]);\n\n\n    return (\n        <div className=\"containerGlobalBasket\">\n            <div className=\"containerItemsBasket\">\n                <h2>Panier</h2>\n                {cartItems.length > 0 ? (\n                    cartItems.map((item) => (\n                        <div key={item.id} className=\"containerBasketItem\">\n                            <div  className=\"basket-item\">\n                                <p className=\"name-item-basket\"><span className=\"textGold\">{item.quantity} x</span> - {item.name}</p>\n                                <div className=\"container-btn-item\">\n                                    <span \n                                        className=\"material-symbols-outlined\" \n                                        onClick={() => handleCommentClick(item.id)}\n                                    >chat</span>\n                                    <button onClick={() => updateQuantity(item.id, 1)}>+</button>\n                                    <button onClick={() => updateQuantity(item.id, -1)}>-</button>\n                                </div>\n                                {commentProductId === item.id && (\n                                    <div className=\"comment-input\">\n                                        <h3>Ajouter un commentaire à votre produit</h3>\n                                        <textarea \n                                            placeholder=\"Ajouter un commentaire\"\n                                            value={tempComment}\n                                            onChange={handleCommentChange}\n                                            rows={3}\n                                            resize=\"vertical\"\n                                        />\n                                        <button className=\"button-comment\" onClick={handleCommentSubmit}>Valider</button>\n                                    </div>\n                                )}\n                            </div>\n                        {item.comment && <p>*{item.comment}</p>}\n                        </div>\n                    ))\n                ) : (\n                    <div className=\"basket-empty\">\n                        <span className=\"material-symbols-outlined\">production_quantity_limits</span>\n                        <p>Votre panier est actuellement vide</p>\n                    </div>\n                )}\n                {cartItems.length > 0 && (\n                    <p className=\"total-price\"><span className=\"textGold\">Prix total :</span> {totalPrice.toFixed(2)} €</p>\n                )}\n            </div>\n\n            <div className=\"containerFormBasket\">\n\n                <form onSubmit={handleSubmit(onSubmit)}>\n                    {deliveryModes.length === 1 && (\n                        <p className=\"delivery-mode-info\">\n                            Mode de livraison : <strong>{deliveryModes[0]?.label}</strong>\n                        </p>\n                    )}\n                    <input type=\"text\" placeholder=\"Prénom\" {...register(\"firstname\", { required: \"Prénom requis\" })} />\n                    <p className=\"error-message\">{errors.firstname?.message}</p>\n\n                    <input type=\"text\" placeholder=\"Nom\" {...register(\"lastname\", { required: \"Nom requis\" })} />\n                    <p className=\"error-message\">{errors.lastname?.message}</p>\n\n                    <input type=\"email\" placeholder=\"Email\" {...register(\"email\", { required: \"Email requis\" })} />\n                    <p className=\"error-message\">{errors.email?.message}</p>\n\n                    <input type=\"tel\" placeholder=\"Téléphone\" {...register(\"phone\", { required: \"Téléphone requis\" })} />\n                    <p className=\"error-message\">{errors.phone?.message}</p>\n\n                    {watch(\"method\") === \"DELIVERY\" && (\n                        <div className=\"container-input-delivery\">\n                            <input type=\"text\" placeholder=\"Code postal\" {...register(\"postal_code\")} />\n                            <input type=\"text\" placeholder=\"Pays\" {...register(\"country\")} />\n                            <input type=\"text\" placeholder=\"Ville\" {...register(\"city\")} />\n                            <input type=\"text\" placeholder=\"Adresse\" {...register(\"street\")} />\n                        </div>\n                    )}\n\n                    {deliveryModes.length > 1 ? (\n                        <select {...register(\"method\", { required: \"Sélectionnez un mode de livraison\" })}>\n                            <option value=\"\">Mode de livraison</option>\n                            {deliveryModes.map(({ value, label }) => (\n                                <option key={value} value={value}>\n                                    {label}\n                                </option>\n                            ))}\n                        </select>\n                    ) : (\n                        <input type=\"hidden\" {...register(\"method\")} value={deliveryModes[0]?.value} />\n\n                    )}\n                    <p className=\"error-message\">{errors.method?.message}</p>\n\n\n\n\n                    <select className=\"select-payment\" {...register(\"payment\", { required: \"Sélectionnez un mode de paiement\" })}>\n                        <option value=\"\">Mode de paiement</option>\n                        <option value=\"CASH\">Espèces</option>\n                        <option value=\"CB\">Carte bancaire</option>\n                    </select>\n                    <p className=\"error-message\">{errors.payment?.message}</p>\n\n                    <textarea placeholder=\"Commentaire\" {...register(\"comment\")}></textarea>\n                    <input style={{marginTop:\"20px\"}}  type=\"submit\" value={\"Commander\"}/>\n                </form>\n            </div>\n        </div>\n    );\n}\n\nexport default BasketComponent;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}